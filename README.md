## Описание проекта
Данный проект представляет собой анализ результатов A/B-теста, проведенного в коллекторской организации.
**Цель теста:** оценить эффективность отправки смс-напоминаний должникам на уровень погашения задолженности.
Платежи учитывались в течение трех дней после взаимодействия.

## Постановка задачи
- Оценить статистическую значимость различий в конверсии в платеж между тестовой (смс отправлено) и контрольной (смс не отправлено) группами.
- Сформулировать выводы и предложения для бизнеса на основе результатов анализа.

## Данные
В проекте используются два файла:
- `data/loans.csv`: Реестр займов, участвовавших в тесте.
    - `demand` — id займа
    - `treat_date` — дата взаимодействия
    - `treatment_flag` — флаг взаимодействия (1 — смс отправлено, 0 — нет)
- `data/payments.csv`: Информация о платежах.
    - `payment_id` — id платежа
    - `pay_stamp` — дата платежа
    - `demand` — id займа

## Особенности
Отсутствие информации о техническом аспекте проведения A/B-теста

## Методология
1.  **Обработка данных:** проверка на дубликаты, объединение таблиц, фильтрация платежей, поступивших в течение 3 дней после взаимодействия.
2.  **Разведочный анализ:** изучение распределения займов по группам и датам теста, проверка на пересечение групп.
3.  **Формирование гипотезы:**
    - $H_{0}$: Конверсия в платеж в тестовой группе = конверсия в контрольной группе.
    - $H_{1}$: Конверсия в платеж в тестовой группе > конверсии в контрольной группе.
4.  **Расчет доверительных интервалов:** для наглядности оценки разницы.
5.  **Статистическая проверка:** Z-тест для разницы долей (proportions_ztest из `statsmodels`).
6.  **Проверка применимости теста (А/А и В/В тесты):** метод Монте-Карло (многократное проведение Z-теста на семплированных выборках).
7.  **Пост-оценка мощности теста:** метод Монте-Карло.
8. **Применение CUPED:** как попытка повысить чувствительность теста

## Ключевые результаты
- Обнаружено частичное пересечение выборок, что привело к фактическому уменьшению размера выборки (до 25% от исходного объема). Тест оценен на "чистых клиентах" 30.10, т.е. на тех, кто был в контрольной группе 25.10.
- Наблюдается статистически значимое положительное влияние смс-напоминаний на конверсию в платеж (p-value = 0.02 < 0.05). Однако, мощность теста составила всего 62%, что говорит о его невысокой чувствительности и надежности (следствие уменьшения размера выборки).
3. Использование CUPED с ковариатой в виде флага оплаты от 25.10 не дало увеличения мощности, так как корреляция между флагами оплаты в тесте и претесте оказалась близка к нулю. 
 
## Заключение и рекомендации
- Не стоит запускать в прод изменения на основе этого теста.
- Так как получившийся эффект является достаточно большим и бизнес-значимым, рекомендуется запустить тест заново. Скорректировать настройки, чтобы избежать пересечений, и заранее рассчитать необходимый размер выборки для мощности 80%+ (с учетом MDE, который важен для бизнеса). Провести тест на чистой, правильно собранной выборке.

## Использование
1.  Клонируйте репозиторий:
    ```bash
    git clone https://github.com/witchyburn/ab_test_analysis.git
    ```
2.  Установите зависимости:
    ```bash
    pip install -r requirements.txt
    ```
3.  Запустите Jupyter Notebook:
    ```bash
    jupyter notebook notebooks/ab_analysis.ipynb
    ```

## Автор
Ольга Маркевич
